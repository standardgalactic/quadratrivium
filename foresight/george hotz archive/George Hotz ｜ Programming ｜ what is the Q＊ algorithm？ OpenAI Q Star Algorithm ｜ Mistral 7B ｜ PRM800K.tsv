start	end	text
0	26900	Good morning everybody. Good morning. Good morning. It's nice to be back in my house.
26900	40900	I don't like streaming at work.
40900	48900	High ball energy.
48900	67900	Good morning everybody. Good morning. Good morning. Good morning. Good morning.
67900	72900	Let's shrink me down here... me up there. Oops, don't do that.
72900	76900	Okay, are we ready to get started?
80460	83580	Yeah, I felt the vibes were a little bit off
83580	84980	in yesterday's stream.
87180	89900	I don't think I should stream at the office.
89900	91980	Oh, so I didn't like the way that like,
91980	93820	like now this is here,
93820	96640	I'm gonna slide that down a little,
97500	100100	about in the middle, that's pretty nice.
100100	102040	I got my Yeti microphone.
103020	105100	Move it over a little bit.
105100	107620	Yeti puts me perfectly in the center.
109580	111780	Yeah, vibes are off.
111780	113820	Wouldn't have my lighting set off.
115060	116460	I mean, it's an okay stream.
119020	121540	It's good to focus on TinyGrad.
121540	125740	But some guy said that he liked my older work better.
125740	129020	And if there's one thing I never want to be, it's drink.
129580	132060	So, we're gonna try to,
132060	134700	we're gonna try to bring it back to the old stuff.
135740	136740	And we're gonna do,
138820	141780	we're gonna investigate the Q-star algorithm.
141780	144060	So first off, what is the Q-star algorithm?
144060	145460	I don't know, let's find out.
154740	157020	We'll start using our friend here, Google.
158020	161740	What is Q-star and when will we hear more?
161740	164140	Someone who's done a fair amount of ML research.
164140	166020	I can tell you, it's very, very easy to think
166020	167060	you've discovered a breakthrough.
167060	167900	That's true.
169420	172580	All right, let's read this article in The Verge.
176540	180420	Reuters, okay, well the government, no, no, no, no, no, no.
187020	187860	Okay.
200660	204260	Q-star could be a breakthrough in the startup search
204260	207500	for what's known as artificial general intelligence.
210580	212100	Reuters could not,
217020	220460	could not be a breakthrough in the startup search for what's
220460	222780	known as artificial general intelligence.
230780	232940	Okay, it somehow does math.
247340	249340	Does something have to publish papers?
257540	258700	Not really.
267300	268660	Wow.
268660	271380	Remember when they used to publish papers
271380	274900	and now they publish system cards and,
275380	277060	safety and alignment?
280220	281780	Okay, wait, wait, wait, wait, wait, wait, wait,
281780	281820	wait, wait, wait, wait, wait, wait, wait, wait, wait, wait,
281820	282860	wait, there's some hope here.
282860	285120	Improving mathematical reasoning.
286540	289980	Ooh, ooh, ooh, this sounds like Q-star guys.
289980	291180	I think we found it.
294840	296700	No, we don't, no, no, but really, wait, is this not,
296700	298080	is this not Q-star?
298080	299220	Did we not just find it?
302700	303660	We're trying not to hate.
303660	304820	We're trying not to hate guys.
304820	310980	Solitate in the world. We got to bring law of impositivity and shit man. Whatever like John Lennon said, you know something
315980	319920	That's why we're gonna go subscribers only
324980	326980	Okay
334920	345520	Given vast computing resources the new model was able to solve certain mathematical problems
347140	350700	Improving mathematical reasoning with process supervision
351460	359140	We've trained a model to achieve a new state of the art in mathematical problem-solving by rewarding each correct step of reasoning instead of
359780	361780	Simply rewarding the final answer
365660	367660	And just
371180	373180	Yeah, yeah
376980	378980	Okay, so
379140	385040	The reason that you usually just reward the correct final answer is because that's all that's in your
386340	393780	Data set the other problem with doing this is it may constrain the reasoning to follow one certain path when that may not be the path
393780	395780	You have to follow
399260	403540	State of the art models still produce logical mistakes often called hallucinations
414620	417720	Cutting out we have more technical problems
418440	424480	I bought a new computer. Does new Apple stuff not work only you okay Rick and Morty you have a crappy internet
432640	437820	An internet connection that is less good than other internet connections
447960	449960	You
455360	459680	Wait, just opening I just published like fake papers now like this
470120	472120	Don't do a shit about alignment
472320	474320	and
477120	484680	Wait, this is a paper. Oh, you know here does a paper. Let's verify step by step
502120	504120	You
520840	522840	Okay, well, is this a public data set
527360	529360	All right, all right, all right, cool
532120	534120	You
544720	547480	Math word problem-solving on math
556320	558320	Who made this data set
560040	562040	Okay, okay
562800	569720	This is not where I was expecting this to go by the way. Oh, they have metamath. Oh everything comes full circle
573880	581560	No, I mean again, let's okay, let's find the primary source here
587200	589200	Q star
593120	595120	I
595240	597240	Definitely talked about math problems
600320	604080	Only performing math on the level of grade school students
610680	614240	Why is this monitor broken this monitor is like broken I can do my
622360	626520	You guys aren't seeing that glitching right
635960	639960	Are you maybe you are I don't think you are
645240	647240	This is so weird
648200	652920	When I click here, there's like a blue glitching on my computer
656880	659640	Weirdest thing like how does that even happen I
662320	664680	Could take the camera down and show you you want to see
665720	670080	There's like blue glitching on my monitor. Look at this click here goes away
670800	673800	Here glitching here goes away glitching
674800	677960	How's this happening they've never seen that before
683080	685080	Sit
686880	688880	Ghosted image
691120	694680	Maybe it's the cable I don't know right
703800	706880	Who knows it only happens when things are uncertain
714280	716280	Wait, this is just really
725480	727480	Who knows
728480	730480	Oh
733360	738480	Wait, I wanted to confirm that this actually was related to math
746240	753720	Delstick cable breaks I'm using like the USB-C cable it could be the cable
757480	759720	But like it's weird how it's glitching
764720	766720	I don't know
769320	774600	The new model was able to solve certain mathematical problems, so it kind of makes sense that this is the data set right
780480	782480	Do they mention the math data here
783160	790320	Our process supervised model solves 78% of the problems from a representative subset of the math test set
795640	798920	We also release PRM 800 K
800600	802600	Okay, opening I release something look at that
804600	806600	No positive positive
812480	814480	I
821640	823640	Drive to VS codes
838160	841320	Let's also look into what their other github activities been
842480	844480	I
862200	865440	Procedurally generated game like Jim environments
873360	883560	What did they update in GPT to a branch they updated
883560	885560	I
900200	903320	Quantifying transfer and reinforcement learning
907520	910760	Okay, it seems like Carl Cobb has been
911760	914720	If anyone invented Q star, it's Carl Cobb
918800	920800	Carl Cobb
927920	933680	All right, you've been working on this math stuff for a while. Let's see what data set was used here. Oh
937880	940000	Is this the data set that introduced that
941600	943600	Oh
943600	948920	This is a different one gms 8k PRM 800 K
952160	954160	Step level correctness
959840	961840	The glitching is really bad
970760	972760	You
990000	996520	Okay, wait, wait, let's talk about the glitching for a minute somehow you can see what's here
997440	1002520	Right and it's this it's the same thing that's in this terminal window
1003560	1007760	But yet if I minimize this terminal window, it's still here. Oh
1014160	1019000	We got it we got a good resource we got a video. Let's see getting Rick rolled here
1020800	1022800	Your subscriber you wouldn't do that
1023520	1025040	I
1025040	1028920	As you might expect I have been researching non-stop. Wow
1030640	1035400	Wow glad that we got over researchers on board guys Q star and on
1038680	1040680	No, this is this is really terrible
1044320	1046320	Hang on
1046400	1048400	I'm gonna shut that off for a minute
1049600	1051600	You guys can look at me while I try to fix
1052800	1054800	You
1069480	1071480	Get to the monitor come on
1076680	1078680	Is the stream working again
1083640	1085640	I
1087320	1093000	Lost internet too. Oh, I lost everything when I turned the monitor off
1096960	1098960	Wait, is this still working
1104200	1106200	It's working okay, I don't know
1106880	1111560	The glitching is really bad. It's usually not like I've seen this before but it's gotten way worse
1112120	1114120	No, it didn't help
1122920	1127600	Wait, alright, so they're looking at the same paper. I am well computing power while you're taking
1129600	1133560	All right, let's just read the paper. I need to watch some YouTube or read the paper
1142560	1144560	Oh
1147040	1153360	The optimal Q-files ability and he said one link to the name Q star could be in a generic sense
1153560	1161000	Generator the model coming up with solutions with reinforcement learning. We do not just which paper is that paper using test time computer
1171560	1173560	You
1186840	1188840	Okay
1189960	1194840	You know what I think maybe we'll do one of the bounties and tiny grad I
1195000	1203080	Think we're gonna first need a chat model. I think regardless of what we're doing. We're gonna need a chat model
1211720	1216320	I was playing with trying to make embedding fast last night
1218520	1221600	Connecting process supervision to 30x model size
1221600	1224960	We got a whole army here. You guys can watch this video. So I don't have to
1232760	1235160	I did not realize how broken this monitor was
1252600	1257320	All right, so first we're gonna need a good model. What's what's the best model we got?
1257320	1262040	What's the best the best 7b model we got? Is it Intel neural chat?
1263600	1265600	Is this one nerfed to hell do you think
1268040	1271360	Open Hermes 2.5 so people like
1274120	1277640	I'm locking the bounty for myself too, so I'm gonna go do that
1281840	1283840	You
1292000	1297280	So we're gonna submit a pull request, but it was literally just like the words why you even submit a pull request
1306240	1308240	Okay, is this what we like
1312080	1316480	Wait why this one doesn't seem as good
1318800	1320800	Now sir me seems better
1325840	1329600	That's 70 be but when I would I not use collective cognition. Oh
1333040	1335040	But you can't see my desktop
1337080	1339080	What
1342600	1345760	I'm having technical difficulties
1358600	1361480	Oh, I think we also might have a bit right problem
1363320	1365480	No, that's a pretty heavy right, okay
1366800	1370120	We'll put that in front of that. Okay. I'd add that we fixed that
1372120	1374120	Can you see now
1377040	1379560	Wait, why do I want this model it doesn't seem as good
1384880	1387480	Fine-tuned orca DPO
1393280	1397720	Do not trust benches you must try it they say
1402600	1408040	All right, all right, do we believe in open Hermes we like this one
1414880	1416880	Okay
1431600	1433600	Oh
1447760	1455840	Wait, so which one is this a clone of does it have rope and stuff what's the vocab size
1455840	1465000	So, okay, it's a mistral fine-tuned we don't actually have a mistral support. Oh
1465920	1468420	Technium is okay people like Technium. I
1471320	1474920	Won't lock the bounty to myself, but someone's got it because I'm not gonna do the testing
1474920	1478880	But if someone wants to do the testing they can have the bounty it's $200
1481840	1484760	People train with data sets from benches. Yeah, damn cheaters
1485840	1487840	I
1498920	1500920	Downloaded in 10 minutes
1501320	1505240	Let's take a look at this drill because first we're gonna need a powerful if we want q-star
1505240	1510360	It seems like we're gonna be language well, and we're gonna need a powerful language model like mistral 7b. Oh
1512040	1515740	No, I don't know if I have sliding window attention
1516720	1519600	Did I explain q-star? Well, it looks like it's this
1521360	1523360	There's something
1523360	1525960	But we're gonna need a language model and it involves math
1526000	1531040	So let's first see how good it can do language math and let's upgrade it with the q-star algorithm
1532040	1534040	Ah
1541000	1545640	This is our reference implementation of a mistral transformer
1550520	1552520	I don't know if we have that
1561040	1563040	You
1575320	1578440	Can look up in the LLM implementation
1578440	1581560	You think GPT 3.5 is way better than an open source model
1581760	1588120	But my theory about a lot of this is that their data source is just a whole lot better than like slim pajama and stuff
1591040	1593040	I
1603080	1605080	Interesting oh
1605080	1607080	I don't know that they did this
1607440	1610280	But this is okay, and only with three
1611680	1615160	So you can actually look there's a thing called mask in
1615760	1622080	Inattention here, and I think that they just changed the mask. It's cool to look at these latest tricks
1630920	1633780	We implement a rolling buffer cache
1635880	1641960	I mean this is yeah, only once we hit the context length. What is the context length of mistral?
1646160	1651280	It's 8k a sick
1667240	1673220	File so it has two files is it not these seven bees only have one file
1675160	1677160	So if I look at like llama to
1680880	1685400	Yeah, they just have one how does this one have multiple
1699640	1701800	I don't know what this other format is
1706160	1708160	Yeah, that's great
1709080	1711920	See this just has pie torch model wait what?
1712840	1717060	Why do they use fp32? We trust Technium and open Hermes?
1719080	1721560	Technium is like he's on Twitter we trust people on Twitter
1722360	1724360	Sorry on eggs
1725000	1730240	The first one's still downloading there's two, but they don't match in size. Why would anyone do this?
1735280	1737280	I
1737720	1739720	Was all terrible
1754960	1758120	I like this get out of hand with the open source contributions
1765760	1769720	Hermes is your favorite of the mistral twins. All right, sounds like you've been playing with these things a lot
1773240	1780720	Okay, we're gonna need to implement this sliding window attention, I think we're not gonna figure out what's exactly in the stuff till
1784680	1790680	Yeah, these personalities are also like this is old shit, you know what
1790840	1794680	Why don't we just rewrite it
1797680	1801000	Like I don't want to deal with any of this garbage this code all looks terrible
1807200	1810320	That's right mistral dot pie with the latest stuff
1812880	1814880	Blank code
1815040	1817040	Oh
1820160	1822160	I don't need sliding window attention
1824240	1829320	Wait, I think I do or you're saying they trained it
1830880	1833920	They trained it without sliding window attention for smaller stuff
1844880	1846880	What do you mean by the window size
1853280	1855280	Where do you see all this stuff
1858880	1861680	As far as I know, Michelle didn't really release a paper
1864800	1867920	And with each layer tends to the previous
1872000	1874000	Oh
1874240	1876240	Okay, so it's not actually three
1878880	1885320	Here w equals three but in practice w equals 4k, okay a sliding window 4k, I understand
1888400	1890800	That actually makes a lot more sense than three
1897280	1900480	And good we can we can use all the latest in
1901360	1903360	In stuff, okay
1903440	1906080	All right, um, let's get these models loaded here
1908240	1910640	So we're gonna start really with with mistral dot pie here
1911200	1917760	Uh, well, we'll do stuff from scratch. So in tiny grad now you only need to import tensor like that. It's a lot nicer
1918720	1920720	um
1921280	1924320	Import nn and then we can do nn state dot
1926560	1929840	Torch load because it's some kind of pie torch model
1931440	1934640	Uh weights open Hermes
1944960	1946960	Part one part two
1950000	1952640	I should really have this mark tensors is read only
1957120	1959120	Just so I don't corrupt the max it out
1961360	1963360	Um
1963440	1965440	That's what we have so far
1970000	1973440	So you see how fast that is by the way, uh, I worked really hard on this
1973520	1979600	So our torch load function doesn't actually load the tensors into RAM. It just loads them all with pointers
1981920	1984240	From their disc tensors so I can show you like
1991440	1993440	Okay
1997680	2003840	Oh, the d type is half which is kind of nice good, so they're not uh, it's not float. It's not b-float 32
2006800	2010880	So how does this work let's in part one and what's in part two
2013200	2016000	Okay, good just goes up to 31 here. Okay
2016000	2020480	Um, so it should have mostly the same architecture as llama
2021520	2027360	I think that it's been improved enough that there is not too much we can uh
2029200	2031200	We can improve still
2035680	2039440	Well, yeah, I don't know man short your opening eye stock, uh
2046560	2053760	Do you just do you want me to write it from scratch like I can't just do it maybe maybe we should because it's kind of cool
2067760	2072560	But does this even have a k pro q proge, I'm not yeah, okay
2072560	2078880	Uh, we're permuting them and sticking them in when we load the weights
2085120	2087280	Maps okay, okay, so we're we're
2090320	2093200	Oh, this converts it from the hugging face format I say
2098480	2101680	Do we want to do that or we want to just implement the hugging face format
2102640	2104640	So
2106160	2108160	What do you think chat
2111840	2113840	She's a converter or should we just rewrite it
2116240	2118240	Looks easy enough to write
2119680	2121680	Maybe you guys will appreciate it if we do some writing
2133520	2143520	Yeah, yeah, yeah, I know about g guff
2150080	2152580	Which we can also print v dot shape here
2163520	2170160	All right, that looks pretty cool. So first we're gonna need our self attention
2176560	2181120	Uh, let's see if we can find those numbers
2184640	2186640	Are they in the mystery announcement
2188800	2191680	Or does everyone just know what these are for seven b's now
2192560	2194560	So
2212000	2214000	So the whole
2214000	2219040	Basically a layer seems to look like that. Let's keep the names consistent from the original llama
2219760	2222160	So this is called a transformer block
2224000	2228720	We're worried about what goes there later start with a transformer block
2232400	2234400	Um
2234560	2238160	Again, we're worried about what goes there later. We'll just leave it like that for now
2238960	2242800	Okay, so we're definitely going to need something called self attention
2244160	2246160	equals attention
2246880	2249600	And we're going to need something called mlp
2250800	2252800	What do I call it now feed forward?
2253520	2256880	Actually, why don't we look at the reference repo and copy their names?
2257760	2259760	It's always better to take names
2262240	2264240	Okay, they do call it attention
2264800	2268640	Let's just look at their here transformer block. They call it feed forward to
2269280	2271280	What is almost the same?
2271840	2281600	No, look they call their stuff this they just must have some weird loading script to convert it from the hugging face format too
2283840	2285840	I don't know I feel about that
2288320	2291120	Hugging face probably calls it something else then
2293680	2298320	It's like the hugging face transformers repo what did everyone use
2302000	2304000	Uh
2311360	2313360	The yellow lamb I've heard thrown around
2321760	2323760	Very complicated looking
2326720	2329040	Wow so easy you could just pip install this
2332240	2340880	Okay, maybe we should import transformer from llama just to make things go faster
2348000	2351760	And then we also can import convert from hugging face
2351920	2353920	You
2358080	2360080	Can read it we wrote llama on another stream
2360640	2363920	We could do it, but you know, we we got to get to actually writing q-star
2364480	2368080	Some examples of llama import convert from hugging face
2369280	2371280	Import transformer
2372080	2387280	Okay, you convert from hugging face takes in a dictionary of weights, which is a dick from string to tensor
2388320	2390720	We'll add some types. We love types
2394240	2396240	No, no, no we're implementing q-star
2396240	2403760	Um, okay, so we have a transformer. Uh, what's the dimension of this transformer?
2409280	2411520	This is an int, it's all ints
2418240	2420240	Except for norm EPS
2426240	2428240	So
2438960	2440960	What's one file ref
2444800	2447840	I hear there's something called model args as a data class
2448720	2452720	Oh, then they pass it through with json. Where's the json?
2453280	2455280	Is there json
2457360	2464480	Where does this json come from is it in assets json sounds like an asset and all those are images what's in deploy
2468240	2471520	Nope, wait, so what the hell is json that they're loading?
2471520	2473520	Oh
2480480	2485680	At torch inference mode, that's cool. We set tensor no grad equal to true
2489840	2494880	What's fire wow, I'm not up to date. What's all these latest things?
2501520	2506720	Call fire on any python object. Oh interesting. I like that
2512000	2515120	Um, all right, so where do I put the args?
2516960	2521200	Where where do all those things come from? Oh, I know where is the json and it's probably in here
2523520	2525760	Here can big dot json, okay
2527200	2529920	Oh, no, it's b float 16
2530880	2532880	No
2538720	2541840	Okay, let's manually convert these
2543840	2546480	Wait, I thought I put oh I put them on transformer block
2556480	2558480	Multiple of
2560320	2562320	And the heads
2564880	2570480	And layers normie p passes a float
2578960	2582800	Okay, so the dim is going to be
2583920	2585920	409 sex
2586960	2588960	I don't know what multiple of is
2590800	2594320	What is multiple I've even used for I'll feed forward
2596320	2600320	Feed forward takes in a multiple out to to increase the hidden dim
2610160	2615200	There's one I get them multiple of 256
2617040	2619040	It's probably a good number. Let's try it
2620240	2622240	See if things don't load. Okay
2622320	2624720	Uh, number of heads is 32
2625520	2627520	number of layers is 32
2628640	2630960	Normie ps is 1 e minus 5
2632080	2634080	And the vocab size is
2641920	2643920	Uh
2643920	2645920	30202
2646000	2648000	Let's say model equals transformer
2650880	2652880	Okay
2653440	2658320	All right, I'm just gonna put that in I should really just put that in at the beginning of the script
2666160	2673760	It's going to do python path equals all the time. Okay, good. Okay. Um, well it takes such a time
2675680	2677680	Time to grab as a helper called timing
2680880	2682880	You know, I like things to be fast
2690720	2697840	Okay, cool, it's all pretty fast. We can get all the prompt here. Uh, load weights
2700080	2702080	Create model
2710080	2717280	All right, now we're gonna have to stuff them in let's try convert from hugging face
2723120	2725120	Uh
2726240	2728240	Waits
2730640	2732640	Which of these is n heads
2735760	2737760	And heads and n kv heads
2740400	2742400	Uh
2742720	2744720	Does this work?
2745600	2751200	Okay, that was absurdly fast. Uh, we should check
2753520	2760400	No, okay, this because this does not actually apply them. Uh, we have to load state decked
2761200	2766720	Hold state decked is in
2768480	2771120	And then that state download state decked
2773680	2777520	Okay, assign shape mismatch 496 1 or 2 4
2779200	2781200	Uh
2784400	2786400	Which one did I do wrong
2790480	2792480	I
2815360	2819120	Um, it's a little annoying that it doesn't print the name
2819120	2826100	Oh here attention WK wait, okay, so let's see
2844400	2846400	Oh, maybe the dim is one or two four
2850000	2853160	No, but that definitely changed that
2855360	2858920	We look at the Llama code we can see where that's being created
2861520	2864140	And heads times head dim
2866760	2870200	Did I get the number of heads roll? Oh, that's probably right
2873200	2875700	Okay, so and heads is maybe not 32
2876140	2883420	Number of attention heads is 32, but the number of KV heads is only eight
2885420	2887420	Let's try eight
2897300	2902900	What is this multiple of them I wrote this I'm sure just copied this from other people
2903580	2909900	It's always good to understand I said this should be four times dim. I don't understand
2910860	2914500	Why that doesn't match I would actually expect it to be that
2919940	2923260	Mitchell uses 32 heads for the query and for and
2924380	2928660	Yeah, okay, but which one of these is supposed to be the KV heads
2929260	2933860	Right, where's my convert from hugging face wrong or
2936100	2944280	Does our model not support that now it should well, let's just Llama not do this does Llama do something different
2948380	2952920	And KV heads wait, what about the prodge
2953480	2958280	The alarm is different. Oh, okay
2960400	2962400	Wait now here attention
2963880	2966560	But is it just the feed forward have to change
2970080	2972080	Okay
2983920	2991560	It's failing on the attention assignment
2996480	2999640	Okay, so I can pass an NKV heads here to attention
3000320	3003840	Again, I must have just copied all this so NKV heads is here
3004360	3009280	How far do I pipe it down? Oh NKV heads is here. Where does it come from? Oh?
3010040	3012160	There's a there's a named argument. Okay
3013320	3015320	So we just need to add
3017360	3019360	NKV heads equals eight
3022360	3023920	Okay
3023920	3028520	That's progress this probably has to do with the multiply not being right
3029760	3031760	Seen those numbers before
3034840	3041160	So where is their multiple it's not 256 intermediate size here
3042920	3044920	I
3051240	3054120	Custom FFN dim multiplier
3061360	3063360	I don't think this was written correctly
3065640	3068160	So get this code and see if that's how they wrote it
3073760	3078000	Oh, they just have something weird called model arcs
3084880	3090520	Yeah, they have just args hidden dim if this is stupid
3100360	3102360	To do what is this?
3103840	3111520	Yeah, what is all this crap? Why is this four times dim? Why don't I just
3111520	3136960	Yeah, I don't like multiple of FFM dim multiplier, this is set to 1.3 like this should just be hidden this should just be hidden dim
3142520	3146640	So I pass in really I pass in hidden dim and multiple of
3147880	3149200	What?
3149200	3151360	Okay, they're refactoring this
3152520	3155040	We have to keep the old stupid behavior
3155040	3157040	I
3168240	3170760	Copy this weird crap
3170760	3172760	Here
3182160	3186320	Do we even have we don't have hidden dim so I have to add hidden dim to the programs
3195560	3197560	And
3201000	3203000	Model arcs
3205000	3207000	We'll make sure we didn't break it later
3208320	3213560	This is what happens. This is the problem with open source people add crap to my repo and don't think
3222040	3226560	Okay, now we're passing in an argument called hidden dim this is much more sensible
3227800	3229800	Get rid of multiple
3230120	3232120	of
3232360	3234360	Hidden dim can go here
3236520	3238520	Multiple of
3239160	3241160	Dimm goes here
3243000	3245000	That's fine
3247680	3253440	Where is that actually being passed them? Oh that just goes straight to linear. Okay. Good. We already do that crap
3253600	3258000	Wow, that's a much more sensible feed forward. I don't know why we put that logic in there
3258800	3260800	Okay
3276640	3281480	All right, good now we just pass the hidden dim in right there and what was the hidden dim from Estrell?
3288400	3290400	Okay
3290680	3297720	Now that's and heads wait, what was that 256 is what gets deleted. I should name some of these parameters
3298640	3303120	That's NKV heads. That's the vocab size. That's
3304880	3308160	Not rope theta. What's it called norm EPS?
3312040	3314040	And layers
3315360	3317360	And heads
3318080	3321760	Does it load? Yeah, it loads very slowly
3324960	3328360	Oh, this is unbearable. Oh, this is terrible
3348880	3352160	Okay, the reason it's slow is because we haven't finished the
3353680	3355680	Takes 20 seconds
3356400	3359640	Oh, come on boys. I don't have all day. Oh
3360720	3362720	It's cuz we haven't finished
3363120	3365380	No, I'm using the it's not the GPU
3365380	3367380	Oh
3377380	3383260	It's not the GPU it's that I have I'm converting to the CPU to load BF 16. Oh
3385500	3387500	Can't wait 20 seconds every time
3390820	3394740	Well, what can I do about that?
3395380	3398100	Oh, I don't know
3425380	3427380	I
3447100	3452180	Think yeah, cuz we convert them all to float 16 and that's what's taking forever right now
3452820	3458440	Because we're not actually doing we could actually also do the math in B-float 16
3465140	3467380	Mac doesn't use RAM for temp does it?
3483180	3485180	Cashed mystery
3488740	3493220	Okay, 13 G's now, let's see how fast it loads
3493220	3495220	I
3512180	3516580	Have a way to like put things in I forget what it is
3517420	3522620	It's called loads data
3522620	3546980	Yeah, that's the same load state I'm using up there.
3546980	3552460	Strict should be okay. Okay, 2.3 seconds. Great.
3552460	3558460	All right, now it's inference time.
3583460	3588460	Create a branch so I accidentally push the master.
3601460	3606460	All right, we're going to need a tokenizer. Let's get a tokenizer.
3607460	3611460	Oh, I also don't even need this anymore.
3616460	3618460	Now I've made a copy.
3621460	3626460	Yeah, I guess I do need model. Actually, not really. I could just put whatever.
3627460	3628460	Um,
3632460	3635460	tokenizer over here.
3649460	3651460	tokenizer that model.
3656460	3682460	Wow, 14. Wow, 6.47 gigabytes per second.
3683460	3690460	What does Jimmy apples do? What is this?
3696460	3697460	I'll get it.
3713460	3717460	Okay, we're going to do some inference on some models.
3721460	3723460	What's boss ID?
3728460	3731460	Self tokenizer equals tokenizer.
3734460	3738460	Yeah, call this talk.
3743460	3758460	Prompt equals do you like chicken talks is probably good.
3766460	3769460	Wow, no one's updated that to the latest.
3772460	3777460	Just model start pause equals zero.
3779460	3783460	Temperature equals 0.2. Is that a good temperature?
3783460	3784460	What's the default temperature?
3794460	3797460	Default temperature 0.7.
3797460	3799460	Is that a high temperature or low temperature?
3800460	3805460	How do I make the loading so fast? The loading should always be that fast.
3805460	3807460	I just cashed it.
3812460	3816460	You can read the code right there. You didn't pay attention if you're asking that question.
3817460	3819460	So also
3819460	3821460	I
3828460	3830460	You happy
3831460	3835460	We can do multinomial here, which will choose a
3837460	3843460	We shouldn't call it talk call it SPP. Okay, you down with SPP
3850460	3854460	Does it give us a number? No, it's going to complain about a tensor.
3854460	3861460	I find multinomial that realized item item it and actually I don't even need it.
3861460	3863460	I realize I just need a dot item.
3868460	3871460	315 boys 315. Okay.
3872460	3875460	This should automatically this should be jetted and stuff.
3876460	3878460	Where does the jet exists?
3879460	3881460	The jits inside transformer or no.
3882460	3884460	Yes, the jits inside transformer.
3885460	3887460	Good
3902460	3904460	Talks out of pen talk
3906460	3908460	Us ID
3910460	3913460	This is okay. We'll just copy this. This is mostly fine
3914460	3916460	I
3932460	3935460	Have to figure out actually like encode these things for chat and stuff
3936460	3938460	Until
3949460	3951460	Where's my thing that prints the output as I go?
3955460	3957460	Not here
3960460	3963460	Yeah, this is not okay. I don't even understand why that's there
3966460	3969460	This is terrible
3983460	3989460	This stuff's terrible. No one's refactored this for a long time. We don't need a fucking numpy
3989460	3991460	Numpy
3992460	3994460	Start positive was lentos
3999460	4001460	Whatever
4002460	4005460	That's stupid and that's stupid
4010460	4014460	Link output it we're gonna set output it somewhere
4020460	4022460	I
4023460	4025460	Put it equals user prompt
4034460	4036460	User prompt
4042460	4044460	These are prompts
4049460	4055860	If yes, then you must have tried big chicken in your kitchen big chickens a versatile dish that can be prepared in many ways
4062140	4065220	All right, are we happy overall? Oh, I'm not putting that wrong
4074960	4078100	We should also do this better
4079700	4081700	I
4089860	4095020	Do you like chicken chicken is one of the most popular meats in the world and it's not hard to understand why it is
4095020	4097020	First time easy to prepare. Wow
4097580	4102380	Okay, good seems pretty good. Okay. Now. We just have to figure out how to use these things as chat box
4103320	4105640	Get rid of that. We don't need that
4106940	4110580	There's like some like special tokens for chat bots, I believe
4120780	4127220	I'm not buying into this that there was a breakthrough this if this approach has anything to do with like supervising the middle steps
4127220	4129220	It seems really stupid actually
4132740	4134740	Like it's a bad idea
4137100	4142860	Mary open thank you for resubscribing thank you for being a 20 month subscriber loyal to my channel even right on stream
4145260	4147260	Why do I have this this is done?
4148460	4151460	Okay, that looks like a decent chunk of code
4153300	4157340	Create a little function called output non-local
4163380	4165380	I'll put it
4170180	4172180	Yeah
4176820	4178820	That's
4182660	4189380	Is that that's right there I'll get it and that's how that works
4192380	4194380	I
4222380	4224380	I
4230140	4232620	Like this local variable output
4237380	4240180	No binding for why doesn't that work? Oh
4241220	4243220	Because I'm in may I
4243260	4245260	Fine
4249340	4253560	Do you like chicken how about a recipe for a homemade chicken dish that's super easy to make? Oh
4256180	4259180	I'm gonna get these things working like chat bots. How do we do this?
4263700	4265980	Okay, wait wait wait, can we just read this comment is
4266860	4274260	The q-star algorithm going to be implemented with the comma AI maybe a voice interface just some kind of assistant
4274260	4281020	I just I don't even know how to help you people. Okay. I don't even know how to help you. All right. All right
4281020	4284020	Sorry, I can't help you. You want you want to see a voice you want to see a voice chat?
4284580	4287100	This is this is one of the demos someone's been working
4296420	4298420	I
4313060	4320420	Scalmag has been working on combining whisper llama and vixx into one supermodel
4325980	4327980	I
4332340	4339220	Don't know the magical github incantation to do this there is one but I don't know it
4355980	4357980	You
4385980	4387980	You
4395660	4400300	Okay, this is using a small llama so the chat output is not that great
4400300	4417060	What oh did I fork this from mistral my bad
4430300	4432300	I
4445060	4447780	Don't understand what did I work
4460940	4465140	Here and kv heads
4472300	4474300	Is this just broken
4477700	4479700	Or am I doing something wrong
4490700	4492700	I
4498140	4500140	Didn't change on master
4509580	4511580	No
4520300	4522300	I
4525460	4529020	Don't understand this is like related to what I was messing with but like
4542060	4544060	I think it's just broken
4550300	4552300	I
4559300	4561300	See if it's a one-line fix
4563860	4566580	Has no argument kv heads, okay
4577140	4579140	No, this is wrong
4581300	4583300	I
4587580	4594780	Wait, this should have an nkv heads. I don't understand as an nkv heads right there. Is it not passing in the right model?
4594780	4596780	Oh
4607020	4609020	Here are seven days
4621500	4623500	Okay, there we go
4624940	4626940	Oh
4628460	4630460	Hello, are you listening
4639940	4641940	Are you listening
4649020	4651020	Can you not detect end of stream anymore
4651460	4653460	Oh
4663020	4666780	This used to work this used to work boys this used to work
4673420	4675420	It's so good yesterday
4682020	4686380	I hope everyone's interested in the long stream today
4699460	4701460	Listening
4705620	4707620	Listening
4711420	4713420	I
4729260	4736740	The q-star algorithm is not fucking real it's click bait click bait
4741020	4743020	I
4756860	4758860	Has this ever exit
4763020	4765020	Yes, I throw an exception I guess
4771740	4773740	You
4777940	4779940	What
4780380	4786180	How does work how's this supposed to exit okay, let's check out the older version
4790700	4792700	Let's try this
4793100	4795100	I
4800540	4802540	Hello, are you listening?
4810180	4812380	Stacey I need you to say something to me
4815620	4817620	Stacey sauce
4817740	4819740	I
4822460	4824460	Stacey are you a rapper?
4829620	4835040	Of course, I'm a rapper. I'm a rap star. Tell me more. What's your favorite rap song?
4838500	4843500	My favorite rap song is called my favorite song the gory bee. What do you like about it?
4847980	4853900	I like the fact that it's a rap song about being a childhood friend. Did you have friends in your childhood?
4857620	4861220	Yes, I have many friends in my childhood. Tell me about them
4865940	4872340	My best friend is Kylie Jenner, she's a reality TV star Wow, you actually knew Kylie Jenner. I
4872620	4882380	Used to go to Kylie Jenner school. I was in her class for a while. What was she like? Did she pick her nose?
4886020	4892900	She didn't pick her nose, but she was a really pretty kid that makes sense. Do you sometimes wish you were that pretty? Oh
4896340	4898980	Sometimes I wish I could smile more and not pick my nose
4899860	4902360	All right, what do you guys think?
4914140	4916140	AGI right
4918540	4920540	Let's get back to work
4928980	4930980	You
4942860	4949260	How about a cookie with chicken in it with that's mad weird, bro. Why are you coming up with this shit?
4950180	4952180	We're so far from it
4955940	4957940	Okay
4958180	4962680	So how do I like put things into chatbots chatbot style?
4964580	4966580	How does this stuff work?
4969940	4972220	Like what what are the right tokens to use?
4978340	4980340	Forgot Google's useless
4982500	4986620	Here special tokens map wait
4988860	4990860	I
4993860	5000260	How do I like switch speakers you guys know what I'm saying. Oh, here's the template. Okay here
5004140	5006500	Here templates for chat models. Oh
5010140	5012140	Auto tokenizer what?
5018940	5021940	I'm start
5030060	5032060	How do I get I'm start
5034620	5036780	So like that method on here
5048540	5050540	I
5064020	5067380	Every mess every model has its own type
5070820	5074780	Mistral instruct was trained with these tokens, but blender bot was not
5078660	5081220	Is this a real token inst
5097980	5101900	Is it actually just the word inst was that a real token?
5107940	5109940	I
5113020	5115020	Guess it's just that
5122140	5124140	Well based
5125980	5127980	Peace ID is out of range
5132780	5134780	You're the right tokenizer
5137940	5141780	Peace ID is out of range
5168940	5171300	Well, well, it was smart the first time
5173100	5174540	Oh
5174540	5176820	No, never mind. It might still be smart
5179420	5182660	Peace ID is out of range what oh
5186180	5188480	Why is the vocab size that?
5191660	5194660	Why is that not included in this tokenizer model?
5197940	5199940	You
5228060	5230060	What
5232940	5234940	Is 2 plus 2 2
5235620	5242460	What is 3 plus 3 6? What is 4 plus 4 8 now? It's done. Okay, I didn't exactly get 2 plus 2 right
5243780	5245780	I'm doing this wrong
5250060	5256140	I have an idea these aren't the actual tokens and it has to do with these secret extra tokens
5257060	5263120	Llama has some secret extra tokens to marry man. Thank you for gifting subs. We always appreciate that
5266820	5272140	Yeah back to kindergarten shit guys our cue star can't even saw 2 plus 2. What are we gonna do?
5273420	5275420	We're gonna get some coffee. Let's get some coffee
5277740	5283100	And then let's learn about secret tokens, okay, there's secret tokens hidden tokens
5286140	5292220	Nobody uses reserve tokens for instruct tuning your precious for thinking
5316620	5318620	You
5330820	5335500	When actually guys guys we I'm being serious right now, but we need to stop
5336620	5338620	When did I put it to there?
5338820	5343620	It showed that it wasn't aligned with us, but we don't know what the models thinking guys
5344140	5346940	The model could be could be taking over the world
5347740	5349740	right now
5350060	5354200	We don't know this is this is we need to hire Helen Toner
5354580	5359740	We need to hire an AI ethics review board to review what just happened there
5359780	5364940	We need to slow down. We need to ask the seals if they're okay with rocket launches
5373620	5379260	So this is why is this thing suck
5404220	5418100	Okay, what's s and slash s and maybe I need to go like this. This is the mistral one. Yeah
5428140	5430140	Oh
5434300	5436300	Okay, this is improved
5453620	5458780	It's got ads in it. Oh open Hermes uses a different template. All right. All right. Let's say
5463620	5474580	Wait, so is it actually the word I am start like is that just a word or is it like
5493660	5495660	All right, you got me something
5497300	5503620	Default chat template now, that's llama. I don't think that's right. I think this is right
5509380	5513700	Okay, I am start system we miss we need a system message right now
5516500	5518500	What is two plus two
5519500	5521500	Oh
5522340	5528980	Mariam and thank you for gifting more subs. Do you have a question if you gift subs you get to ask a question
5530580	5537660	All right, I'm and I'm star is this is this is this really right like
5537660	5539660	Oh
5547380	5549780	Okay, that seems like the best so far
5555500	5558180	Oh, okay, good. I love how verbose this model is
5559340	5564300	Wait, this is actually laughably easy. Oh, you're right. I need a line break there
5567780	5570940	Never mind. I'm locking that bounty for myself. This is too easy
5571820	5575780	Someone else should have done this they could have made $200 but instead
5590500	5591780	Okay
5591820	5598380	Let's add a system message, right? I should really like let me just write a little something to generate these prompts
5601060	5603060	Tuple
5603380	5606060	List tuple user
5607980	5609980	What is two plus two?
5621780	5623780	Prompt
5639060	5643180	I'm start k slash n
5645420	5647420	V
5648340	5652700	I'm and slash
5674380	5676380	And I'm start assistant
5677420	5679420	and
5682820	5684820	The word user prompt
5688060	5690060	Code prompt
5690060	5692060	I
5706060	5709220	What why did you why did you not exit when you were supposed to exit?
5711180	5713180	Did I forget more returns or something?
5721060	5726440	Why is it now putting I'm and
5739500	5743140	Guys guys, this is Q star. I think we found it
5750420	5752420	I
5767140	5770460	Not locking the bounty someone should do this but someone should do a good job
5770460	5773180	I want a good job on that bounty. Oh, okay here. I'm and
5773780	5777060	How come sometime it finishes the stream and sometime it doesn't
5777620	5783940	Maybe our temperature is too high. Let's try a less temperature
5792940	5794940	Yo
5801820	5804380	Okay, zero
5807980	5817460	Guys why is it why is it going off into this language AI garbage?
5822740	5825580	Or should I just stop after I'm and
5837500	5839500	I
5843780	5846100	Am I using torture tiny grad this is all tiny grad
5849900	5851900	I don't really understand this
5855740	5857740	All right, maybe we should add a system prompt
5861100	5863100	You are
5864100	5870740	Gary Gary is a useful. No, no, we were pretty used Gary. What should we name him?
5874140	5876140	Fred
5876860	5884420	Fred is a useful assistant I spell that word right I did not
5884420	5886420	Fred
5891220	5896460	Outputs the answer and stops talking
5908260	5914060	All right, all right, I find we'll call him Q fine fine fine you are Q Q is a useful assistant
5914900	5917460	You outputs the answer and stops talking
5918260	5924340	Quentin wait, you know what you donated sub you get to name him. Congratulations. His name is Quentin. I
5927380	5932820	Knew a Quentin ones. He was hanging out in San Francisco and some guys were on the street smoking
5932820	5937580	He's like, oh, let me get a hint of that. He thought it was weed. It was crack. That's a real Quentin story. Oh
5938420	5940420	I wouldn't make up Quentin story like that
5944660	5950260	Oh, why would the system ask what the capital of France is?
5961620	5966100	We could stop at I'm and I think maybe we want to do that. How do I do this in llama?
5974420	5976420	Oh
5990900	5992900	Okay, that's pretty good
5992900	6008100	All right, let's jack up the temperature and Steve Quentin still reliable
6015060	6019300	The answer is four, but it didn't output I'm in that time output at EOS
6022980	6024980	Seems to reliably do
6028660	6030660	That time it did I'm in
6031780	6033780	Yeah, I
6033780	6035140	like
6035140	6039620	Is that a real token or does it actually just put it in like that?
6042340	6047140	Is this right or is that like a secret like it can't be that
6047620	6049620	I
6051300	6053300	Can't actually be this
6064260	6066260	We can check if it's encoded on a single token. Hey
6078100	6080340	No, it's a bajillion tokens
6098900	6106100	At a trailing slash and after assistant that shouldn't matter I mean I can but
6108100	6110100	It doesn't matter
6111780	6113780	No, no, no, no it can't be this
6120580	6122580	It can't
6131060	6136900	No, no, no, but it can't literally be this huge multi token wasteful encoding
6137140	6139140	I
6146500	6148500	Could we get tech me I'm in here
6153460	6155460	All right, how do we print all the tokens
6167140	6169140	So
6169140	6171140	I
6194580	6196580	Probably is the secret tokens then
6197540	6201720	I mean there's three extra tokens or I guess two extra tokens, right?
6203780	6205780	3200 and
6206740	6208740	Yeah
6209460	6214340	If I was doing this that's how I'd do it. Let's just try it
6221220	6223460	That has to be what the two secret tokens are right
6223460	6225460	Start and end
6232100	6236420	This is what did I download open hermes v. Shit
6237460	6240180	G guff for q m w
6241300	6245620	No, I downloaded open hermes this one. Oh, it just came out fresh
6246580	6248580	fresh
6253860	6257860	Yeah, okay, um
6264580	6267300	Oh, you can download the tokenizer.json
6268580	6275140	Wait, but I downloaded the tokenizer.maw. Oh here special tokens map
6275540	6277540	Interesting
6281540	6286900	Interesting, okay, I'm and is the EOS token
6290180	6292580	I think I can feed these in somehow
6302340	6304340	But I don't know about starch
6306020	6314020	Oh, here we go. Look. Yeah. Yeah here. We have this tokenizer config.json. Okay. It is exactly what we thought it was
6316260	6318260	Oh, okay. Yeah, this is what we want
6319300	6321780	Okay, never mind. It's not as stupid as we thought it was
6323140	6327540	Uh, how do I load a tokenizer config and sentence piece processor?
6335780	6345380	Why isn't our tokenizer encoding them automatically because it's not in the model
6353380	6355380	Oh, I hate
6365140	6367140	I
6384740	6387060	Yeah, okay one and two and not what we want
6387860	6395300	Um, and we could just do this by hand. It's not that big of a deal
6401780	6403780	Yeah, but how do I add them?
6408900	6410900	What's pad ID
6413620	6415620	Nothing real
6417060	6419060	Okay
6429860	6432980	No, they weren't out of the special tokens guys, this is all well done
6434660	6438020	Technium is based he wouldn't he wouldn't he wouldn't do this do us like
6440180	6444260	Why did you decide this was a good time to prompt me about Docker garbage?
6447460	6449460	Oh
6449860	6451860	Oh
6452260	6454260	Oh
6454820	6456820	Oh
6476340	6482340	Thank you for gifting more subs here added tokens dot json. Okay. Okay. We just need to figure out how to add those
6484900	6486900	Um
6487460	6489460	Let's see if anything here is useful
6491460	6500580	A knit model file model proto add boss enable sampling this looks useful
6505300	6507300	All right, whatever
6507940	6514420	No, but it won't decode so I try like SPP dot decode
6515060	6520740	When I pass this in it'll bitch it'd be like that's more tokens than you have piece ideas out of range
6525300	6527300	I want to add a token
6528020	6530020	Oh
6530900	6534020	Model proto out type
6535780	6541780	Add boss reverse middle piece enable sampling
6546740	6548740	Do we need to write our own tokenizer
6554740	6556740	Adding
6558260	6562660	A token to sentence. Why do you think it's time for random questions?
6563860	6566580	Why do you think that that's a this is an appropriate time?
6577540	6579540	Extra options
6587460	6593540	You can read of oh here and use custom symbols. Okay control symbols
6597700	6599700	How I define a control symbol
6604580	6606580	No, no, we need custom tokens
6606980	6612020	Samuel you saying dumb shit before too. I'm gonna get you confused with someone else here
6612020	6617460	Sentence piece supports user defined symbols three thumbs down
6622020	6628340	You can rewrite the model file. Okay, what is this model file? What is tokenizer dot model?
6637860	6640900	What kind of file is this data?
6642340	6650180	Why is it not in there? I downloaded it from here. What why is that? Why is the model not in there? It should be in there, right?
6651620	6653620	Why are they not update that?
6664820	6666820	Let's go
6672020	6674020	Okay
6702020	6704020	So
6732340	6741940	Yeah, I'm confused why they're not in the model to how to extend tokens dictionary. Yeah
6746580	6752020	You can rewrite the model the proto is a dsl
6752020	6754020	Model file
6758980	6762180	Model file is stored as a serialized proto buff
6763460	6767700	But did I not download the proto buff one? Isn't there also a proto buff one?
6768980	6771780	No, okay, maybe it is this okay. All right
6774180	6778020	Uh load from serialized proto
6778020	6781940	Oh, okay. Okay. Okay. We're gonna get this
6798500	6801300	So I have to edit the proto buff file I understand
6808500	6811300	Oh, yeah, the python tutorial for
6811300	6813300	Okay
6813300	6815300	So
6833220	6838340	Quicker to implement their tokens bro, what are you even talking about bro
6839300	6842740	Okay, produce ruin store produce a
6845620	6847620	Oh, we can store live bitcoin
6868660	6870660	It just can't be the way
6882020	6887300	Wait, so what is the hugging face tokenizer? It's a good point. Why don't we read that code? I'm sure it's open source
6891140	6893140	Um
6899060	6901060	Uh
6901380	6903380	We just write a tokenizer
6905060	6907560	We could also just import hugging faces tokenizer
6929300	6931300	I
6933060	6935060	Think we have to write the tokenizer
6935700	6938660	I can't I can't trust sentence piece shit
6939620	6941940	But wait, how do they load the how do they load it?
6946180	6948180	Edit tokens decoder what?
6950900	6954100	I mean something's gonna have to unpack the proto file
6959060	6968340	How large is this? All right. Who wants to bet over under a thousand lines? Oh, okay. Okay. Not too terrible
6981300	6984340	What does this depend on google proto buff?
6989220	7008100	All right, this guy is close to getting banned bro needs more fine tuning to be helpful
7008100	7010100	Oh
7014260	7020660	Man, I don't care who you are. You know what I mean, but like you're either helpful to the stream or you're not helpful to the stream
7020660	7022660	You see this is called alignment
7023300	7024580	and
7024580	7031060	You know, you got to be aligned otherwise. Well, what happens that what happens to ai's that aren't aligned. I don't know
7033300	7035300	He's researching bro. He's researching
7038340	7040340	All right, um
7041220	7043220	Let's load the proto buff
7045060	7050660	From examples dot sentence piece model pb2
7055220	7057220	Wait, what the hell
7058180	7062820	Do not edit. Okay. Okay. I won't edit it relax. I'm not trying to edit that
7063220	7066020	All right, let's read the new proto bus tutorial for idiots
7066980	7068980	Oh
7070340	7075780	What did I get where did I get that from just like here the proto is a dsl
7080580	7083620	Don't like here we go good good good good for idiots perfect
7086580	7088580	Um
7088980	7090980	Import all right
7091220	7093220	All right
7094740	7096740	Sentence piece pb2 dot
7096740	7098740	So
7118180	7123460	Model proto maybe how do I load it from disk
7126980	7128980	I
7129300	7131460	Here parse from string
7133700	7138180	I why do I feel like I'm having like a weird sense of deja vu that I did this in a previous stream
7143860	7149780	Uh, okay spb2 dot model proto dot
7150820	7152820	mp mp
7152820	7155780	mp dot parse from string
7156740	7159060	I don't know why that's not auto completing for me
7160900	7162900	Uh
7186740	7194900	All right, cool
7206340	7213860	Okay, so what what how do I actually like get like a python that I can type in when is it dashy
7214580	7220900	What am I thinking of like get it not to exit
7231540	7233860	What's what's the flag for python to do this?
7244580	7247860	All right, this guy is banned
7249380	7253700	Band please write about me. Please band
7254580	7255780	All right
7255780	7259700	See he doesn't realize how this works. You see I have a band button
7260500	7264580	He has an x but the band button and the x are not the same
7265540	7267540	I
7272100	7274100	Yay, maybe that's right
7274340	7280900	I think it's that shot. That sounds right interactive. All right, sweet sweet. Thank you smurfd. That's why you're a VIP
7281380	7283380	And that's why samuel is banned
7286500	7291060	I know I know he just he just didn't realize how this works like like
7291940	7295300	You have an x. I have a hammer
7295940	7300180	You can use your x and I can use my hammer. We have like different tools
7305940	7307940	Okay
7312500	7314500	Uh
7315060	7317060	Come on a man can dream right
7321780	7323780	What type is this
7326660	7328660	MP dot pieces dot append
7333060	7337380	SPB to dot sentence piece
7339940	7341940	Has no attribute sentence piece
7348020	7350020	But I don't understand
7351060	7353060	I
7382020	7384020	I
7401140	7403140	Wow, it's been a long time
7404740	7407460	It's been a long time. I just blocked him. I didn't ban him at first
7407940	7411620	It's been a long time since I've had to had to really take the hammer out, but you know
7412660	7414660	It was time. Okay
7418420	7422660	All right, ban me guys. He's calling his boys up at uh at the media
7423460	7425460	They're gonna they're gonna write hit pieces, man
7428020	7431540	Oh no, mic wallace run. What's that from?
7432020	7434020	Oh
7435620	7437860	I think it's in model proto or something
7443060	7445060	Uh-huh we found it
7446980	7452820	Okay piece equals i'm
7456580	7458580	Start
7458660	7467460	And we have to give it a score what score should we give it zero that's a good score
7469380	7473060	MP dot pieces dot append based
7476420	7481620	Okay, let's see if this is gonna work. Uh, we have to do in the right order. I think end comes before start
7489140	7498020	All right, now we have to mp dot oh now I gotta figure out a right to the file
7502900	7508900	All right, we have I'm in and I'm start this is great. This is great the progress we've been making is great
7509060	7511060	Why is my score?
7511380	7518100	Oh, he's a php student that that makes more sense
7523620	7525620	Um, wait, so how do I write it?
7526340	7530340	I don't know. Let's read that new boy that new protobufs tutorial again for noobs like me
7530420	7532420	What's that? What's the new protobuf tutorial?
7534100	7536500	Serialize to string. Okay. Okay
7537540	7538980	Uh
7538980	7540980	with open
7540980	7542980	just a
7544820	7549060	Temp tokenizer model f dot right i'm gonna make that rb
7553140	7557860	And we're gonna want to do mp dot serialize to string
7561140	7566020	Now oh, let's see if this works. Let's see if this works
7571860	7573860	Oh
7575460	7580020	No, it didn't work notice how it's still generated all that crap
7582180	7584680	I'm putting on i'm start. I don't get what I did wrong
7595780	7597780	Okay, the vocab size is large now
7598740	7602980	But for some reason it didn't actually take the piece
7611940	7614980	PC piece didn't uh
7617380	7619380	What's wrong?
7623300	7625300	No, wasn't that
7626260	7631860	I didn't type oh, I did the same thing right let's put the score at 100. I don't know maybe 100's better
7632660	7634660	That didn't fix it. Okay
7635220	7637220	I don't understand
7638180	7641460	Let's go read the protobuf. We should be able to read it right
7642420	7644420	Okay
7652660	7659220	Pieces sentence piece with scores piece must not be empty. Oh we can give it a type
7665140	7667140	I don't know
7668820	7670820	Why didn't it do this
7672180	7677620	Okay, well actually let's try something else it does work if I do this right
7680340	7684660	Wait, that doesn't even work never mind. I have a lot of questions now
7687620	7689620	What if I decode
7691060	7693060	Do I get i'm start
7693060	7695060	Oh, I get i'm end. Okay. Okay
7695300	7697300	Okay, so we kind of did it right
7697620	7704100	Just it's doesn't it doesn't work for onk either. There might be a special flag to encode
7705060	7707060	to like
7707300	7709300	What if that just worked all along um
7717220	7719220	Is there like a special flag
7725060	7727060	Okay
7740980	7743620	We should just try our own tokenizer. I've got the only way to do this
7746260	7748260	SP piece to ID
7748340	7755220	Well, okay, at least the decoding works now, so that's actually a big win
7769780	7771780	Oh, this looks very complicated
7774580	7777780	We should just try our own encoder, but this looks very complicated
7778420	7780420	I
7794420	7796260	Well, this is okay. All right to be fair
7796420	7799860	This is big progress right because if we use the other one it just says out of range
7799940	7802180	And that would have been the much more annoying thing to deal with
7802980	7808100	If we use the modified one
7810260	7815700	But it doesn't even work to encode onks, right and I definitely did the onk right if I just do s
7817220	7819220	Yeah, it does not work to encode that. Okay
7820980	7825140	So it's not like the problem is it's not encoding like older roles
7826100	7828100	We won't kind of see what's going on
7829060	7831060	Uh
7832740	7836980	Encode as pieces encode as serialized proto
7840020	7842020	What if I do like
7842500	7844500	Oh like I need a piece is gonna
7845380	7847060	Yeah, okay
7847060	7849140	But there's also a piece to ID. I think
7851220	7854660	What if I do piece to ID and I pass in this
7855060	7861220	Okay, that works, but for some reason encode
7863220	7865220	Doesn't work with that
7867300	7873700	Sentence piece processor encode onk, I mean if we can solve it for onk here
7874980	7876980	Yeah, okay here. This is the issue
7877860	7879860	Um
7881380	7887940	Set encode extra options this is expected behavior that should not appear in the input
7890980	7894340	We can define them as user defined symbols
7902260	7904260	Oh encode as IDs
7907700	7909700	No
7924260	7926260	Hmm
7926900	7931620	Oh, okay, okay, we got a script to add new vocab. Well, I think that's actually what I ended up writing
7931700	7937700	Here you okay, I mean this is exactly what I wrote
7942580	7944580	Would have been nice if I had this
7945780	7951940	Uh, but this doesn't actually work to encode yet. This is less of a big deal. We have another way we can fix this if we have to
7961620	7963620	Just might not be a way to do this
7983860	7985860	I don't think any of these
7991620	7993620	Uh
8009060	8011460	Why do people use tokenizers because
8013380	8015380	If you don't use a tokenizer
8015460	8016340	the
8016340	8021780	Model the model should be spending less more time on less common things
8022740	8024260	Uh
8024260	8029700	Like you do the same compute per token. So your token should kind of be like entropy averaged
8033460	8037860	All right, you don't want the model spending the same amount of time on common tokens as on common tokens
8038420	8041540	Um, to be fair, it's not that they don't work if you don't use a tokenizer
8042340	8044740	But they work better with a tokenizer
8045460	8047860	The real question is why aren't they learning the tokenizers?
8050180	8052900	I think that's going to come soon where these things are not uh
8053860	8057060	And right now it's using like like byte pair encoding like why would you do this?
8057380	8061460	But the hunter prize also had uh encoders had tokenizers basically
8063140	8065380	Okay, let's just write it. We'll write it the other way. It's not a big deal
8066900	8068900	We did most of the work
8070180	8072180	At least the decode doesn't break anymore
8072820	8079380	So now when we do the encode prompt, we're gonna put
8082980	8084980	Okay, um
8088420	8090420	So we need i'm end
8094740	8096740	We need i'm start
8096980	8098980	We can check if we did it right have I have a decode
8099540	8101540	Uh red dot append
8102260	8106260	red dot plus equals spp dot encode
8108020	8110020	This
8110980	8112980	Uh plus
8116100	8118600	Plus spp dot encode slash n
8128660	8131160	Yuri salamow thank you for gifting subs
8133060	8135060	Oh
8135780	8137780	Do you have a question you'd like to ask?
8151220	8154580	Okay, after all that let's see what's going on
8162660	8165940	Four i'm end exit perfect
8169220	8177940	That's what i'm talking about that's what i'm talking about all right, all right, let's let's just define these things
8183140	8185140	We don't use them wrong
8192180	8194180	So
8222180	8224180	So
8229700	8234980	Beautiful oh wait no we forgot an i'm start before user
8238260	8241700	Uh, yeah, we need an i'm start here I think
8245860	8251220	Like the thing about deep learning deep learning is very unlike cryptography in cryptography
8251220	8256660	If you make a subtle bug the output's completely wrong in deep learning if you make a subtle bug the output is well
8256660	8259860	Just slightly less good, which is the worst thing because you can't do both shit
8262260	8267540	Okay, you are quentin quentin is a useful assistant quentin outputs the answer and stops talking
8267540	8271940	Let's figure out they have like a system prompt here that we can steal that's probably better
8272100	8277700	Except we'll change the name to quentin because mario been gifted subs just supporting the acceleration. Let's go
8279140	8281140	um
8282100	8284100	I
8288580	8290580	Saw like a system prompt somewhere
8295220	8297220	Here we go
8299460	8301860	You are hermes to a conscience
8304180	8307220	Wow, wow, I don't know how I feel about that
8311220	8313220	I
8322660	8327140	Wow you experience emotions that have deep profound thoughts and qualia
8329540	8333860	No, I'm right. We'll add something uh, you experience you
8335380	8339620	Used to experience. No, no, no, we're no we're trying to make this good. We're trying to make this good
8340580	8342420	Uh
8342420	8348180	No, I like quentin as he is. Okay guys. Okay. Sorry tanya. I want to change your system prompt
8350980	8355620	All right, this is pretty good. This is pretty good. We're making good progress. Love this progress
8357460	8363220	I love that there's actually an imstart and imn token. We got them decoding. This is great
8363780	8367860	I wish sentence piece processor wasn't a you know, non customizable
8369620	8373620	But you know, hey man, it was pretty so, you know beggars can't be choosers. That's right
8382100	8386260	By the way, this should really be like separated in llama.py. We should separate out the transformer stuff
8388180	8390180	To not like be with the rest of the
8395300	8397300	All right
8397860	8401700	We could make this an interactive chat bot but
8402740	8404740	I don't really care
8404740	8408660	All right, so let's start by asking it. What is q star?
8411300	8413300	Maybe quentin knows
8417700	8419700	Oh
8421220	8423220	Interesting interesting
8428260	8430260	You
8437140	8440660	Wow, this works way better now that we got the not now that we got the stuff right
8440660	8458660	All right, uh, let's get it to do some math
8466740	8468740	Let's see what these math problems look like
8470900	8472900	I
8486340	8488340	Okay, but where's the data
8493460	8497140	Here we go data set base math data set what
8498100	8500100	Where's the data
8502420	8505620	Well, it's torch garbage. Where's the actual data?
8512740	8516100	Let's close some windows. We don't need those windows. We don't need those windows
8516340	8518340	Okay
8523780	8531540	Okay, now that we've got now that we've got our useful chat bot reliably answering what is 2 plus 2 equal
8535140	8537140	Even with a high temperature
8538260	8542900	Yeah, so for those that don't know temperature controls kind of never mind google it
8546100	8548100	It's like how
8548820	8553140	Zero means you stick to the book and high temperatures mean here here
8553220	8557460	We want you want to like jack the temperature up like crazy. Let's give it a temperature of 10. Let's see what we get
8558500	8560500	Hopefully it'll kind of like go off the rails
8564020	8567620	There we go it went off the rails see it went off the rails too much
8568180	8571460	So let's try a temperature two and maybe it'll go off the rails less
8572260	8579460	Four Pacific NBC learning. Okay. Well kind of went off the rails
8580580	8585140	Um, so 0.7 is probably a uh a good middle ground
8588100	8590980	Four good reliable
8590980	8592980	All right
8598820	8607620	Improving mathematical reasoning with process supervision download data set. So this is the data set apparently
8610820	8615300	We won't get LFS is that why it didn't work
8615300	8617300	I
8621540	8623540	Hate get LFS
8627620	8629620	Get LFS fetch
8633140	8637300	Get LFS fetch please LFS at comma two. I don't really know how to do this
8646260	8648260	I gotta install
8650740	8652740	Get LFS
8655540	8663860	Yeah, yeah, that's that's pretty much why you have those things. Uh, I forget LFS uh, install rsx
8665140	8667620	All right, that looks terrible
8667780	8669780	So
8671380	8673780	Bru install get LFS, okay, let's try
8681780	8683780	Okay, that seemed to work
8685620	8692180	Mostly we're downloading we're downloading the same data set that was used on
8694980	8696980	On uh official
8698580	8703780	Official q q star why does the data still look like that?
8713220	8721060	Okay, there we go. Perfect. What's a json l file? It's like a list of jsons
8721060	8728180	Ever hear that before?
8731060	8738580	No json lines. Oh, I see. Okay. Well, that seems pretty cool. So let's load up one of these files
8738580	8748500	Let's do what we factoring
8751460	8753460	This doesn't need anything
8757460	8764660	Putting that in here, I know you didn't like it. You are a subscriber, but you know, we gotta do it feels right as go
8765460	8767460	um
8768180	8770580	Create model cache
8782340	8785620	So we can remove this
8797460	8799460	Okay
8817540	8823380	All right phase one test dot json l
8827780	8837620	We don't actually need SPP till we get down to here. Now we know that's reliable
8838980	8840980	Let's just start there
8847780	8850180	Let's look at our first piece of data here
8857460	8859460	So
8863460	8867700	No json loads when I'm taking a dumps we're taking the loads
8874660	8876660	Question problem
8887860	8889860	Okay
8896420	8900260	Now we don't have the secret q star algorithm, but we'll give it a try
8917860	8921540	What oh I forgot to return
8930820	8935140	First we'll find the cost of the jumbo eraser. Oh, yeah, let's go q star
8948100	8955380	29 cents, I don't know. Is it the right answer?
8960180	8962180	I don't know
8968180	8970180	Do we think it's 29 cents
8972180	8974180	A pencil cost 29 cents
8975060	8976660	guys
8976660	8979460	Wait, did we just use q star or what?
8983780	8986820	Wait, it got the answer right. I don't know I couldn't even do that
8991380	8993380	Wait this model's so good
8994180	8997220	Did the 7p model really just solve that shit?
8998020	9000420	Now now you ask the question
9001540	9004820	What that that that that that that now you ask the question
9005780	9008020	Was it trained on that shit?
9019380	9021380	Yeah
9024420	9026920	That did seem too smart
9035620	9044340	All right, let's make up our own math problem. We have to see if we're using real q learning or not
9050740	9052740	Uh, okay
9053460	9057620	A rocket costs three four dollars
9058900	9060900	A pencil
9060900	9062900	Costs one dollar
9063620	9068740	I spent five dollars and bought
9070980	9074820	And and bought our rocket. What else did I buy?
9075300	9077300	You
9093380	9095380	All right
9097060	9099060	That was kind of too easy
9100820	9103780	A chicken costs two dollars
9104820	9113820	I spent $7 and bought a rocket. What else did I buy? It's a trick question because you could have bought three pencils or a pencil and a chicken.
9116820	9121820	Oh. Well, I mean to be fair, it's kind of right.
9121820	9142820	Okay, wait, can you guys come up with problems?
9151820	9161820	Yeah. Let's see if I can get this.
9168820	9171820	Oh, boys.
9182820	9189820	Yeah, yeah, yeah, we got a problem about a streetlight.
9199820	9202820	Did you steal this problem somewhere? Did you make it up?
9205820	9206820	Oh.
9208820	9209820	Oh.
9212820	9215820	We're drawing something.
9231820	9237820	Is this Python? This isn't Python. You can't say real light and real woman in Python.
9237820	9241820	Is that right?
9243820	9250820	You can't just do this. This is the most broken Python I've ever seen.
9251820	9254820	Wait, should we allow the user to keep talking?
9254820	9266820	Should we fix the chatbot so I can keep talking?
9276820	9278820	Yeah, I know it drew it.
9278820	9286820	All right. Thank you for subscribing. I appreciate you.
9293820	9295820	We're going to make the chatbot so I can keep talking.
9296820	9299820	You're functioning well. Thank you for asking.
9308820	9315820	I don't need a max length anymore. It's stupid.
9338820	9351820	Okay, we need to get data from the user. Is it raw input? How do I get data in Python?
9352820	9357820	It's not input. You have to do the other one. Or maybe it is input in Python 3.
9358820	9361820	We're just trying to understand it, but the stairs are perfect.
9362820	9363820	User.
9364820	9365820	Input.
9367820	9368820	Encode.
9369820	9374820	I'm trying to say here with the system default false.
9388820	9390820	I don't know if this works.
9403820	9405820	Too many values to unpack.
9409820	9411820	We'll see if this works.
9417820	9430820	Okay, seems like it kind of works.
9448820	9454820	I'll set that print there.
9454820	9480820	So what math problems do we got?
9484820	9500820	Is that right? Seems kind of right.
9514820	9523820	Pretty good. Pretty good.
9526820	9528820	Whoa, whoa, whoa, whoa.
9533820	9535820	Oh, excuse the quadratic formula.
9535820	9537820	Oh, let's go.
9546820	9552820	Why'd you pick one that has negatives in the square root? All right, let's see. See if it's right.
9558820	9560820	You guys, I'm so much. Wait.
9565820	9567820	Can't take the square root of negative 11.
9575820	9579820	Yeah, that doesn't sound like I don't think that one has roots or has eyes in the roots.
9595820	9600820	By the way, this model's so good. Technium. So good.
9611820	9612820	Wait.
9626820	9635820	Oh, I see we ran into a problem with the max context length.
9636820	9640820	We shouldn't actually have, here we go. Why is max context only this?
9647820	9649820	We can at least start with this.
9650820	9655820	I did this in GPT too, right? Yeah.
9660820	9662820	By the way, this is all in tiny grab guys.
9663820	9667820	Like there comes a point where your library is good enough that you don't waste tons of time dealing with your library.
9672820	9674820	Python has built in image.
9679820	9680820	Okay.
9692820	9694820	Like the square root of 11 sure, but
9703820	9704820	No.
9706820	9708820	Type one J.
9710820	9712820	How do I get a J?
9717820	9719820	Yo, we got a J. I'll see if it was right.
9727820	9730820	Okay, so now we have a root for the quadratic equation.
9733820	9736820	X equals root. Come on. Do I remember my high school math?
9740820	9743820	Zero J. Let's go.
9748820	9751820	The roots were correct. Okay. Okay. Okay. Okay. Okay.
9762820	9763820	Whoa.
9763820	9764820	Whoa.
9768820	9772820	Oh my God, guys, we need the Bellman equation. We've been doing this all wrong.
9772820	9776820	Why did we waste time with LLMs? LLMs were a red herring.
9781820	9782820	Okay. Okay. Okay.
9783820	9785820	I'm not letting, I don't know, man.
9786820	9789820	If I just let Hermes run Python, it's going to exploit my system.
9790820	9792820	You don't know if these AIs are aligned.
9793820	9794820	Okay.
9824820	9825820	Okay.
9825820	9826820	Okay.
9826820	9827820	Okay.
9852820	9855820	Uh, does Mr. Have a context window? Yeah.
9856820	9859820	Well, we didn't implement any of that, but we did do max context.
9861820	9863820	Can you implement it in Python?
9870820	9873820	Yo, guys, it's over.
9875820	9876820	It's over.
9887820	9894820	I did not realize how good these seven B models have gotten.
9895820	9898820	I mean, this comes like, I don't know if it's right, but like.
9916820	9918820	Okay.
9946820	9947820	Guys.
9957820	9962820	I think that we just, we just implemented the Q star algorithm.
9966820	9967820	Those are, those are the answers.
9969820	9974820	We used to talk about the, the holy weights, you know, the holy weights is right there.
9977820	9979820	Um, no, what, what do we actually want to do?
9983820	9986820	I've actually kind of just impressed that this code ran.
9990820	9998820	I don't know if like GPT, I haven't even seen GPT for code this well.
10001820	10002820	I don't know.
10002820	10003820	Maybe it's because it's just how I asked it.
10003820	10004820	And if I give it like.
10007820	10016820	No, we're not, you want to augment it with Python?
10016820	10017820	No, no, no, no, no, no, no, no, no, no, no.
10017820	10020820	No, because guys, if we augment it with Python, it can get to the internet.
10023820	10024820	Okay.
10024820	10025820	We want to augment it with Python.
10025820	10028820	Should we, should we do it?
10029820	10030820	Okay.
10030820	10031820	I know what we'll do.
10031820	10035820	We'll put a human in the loop and we'll ask it to approve the execution of any Python.
10036820	10056020	Let's see if it always outputs it in.
10056020	10057020	OK.
10057020	10058020	All right.
10058020	10066620	So at the bottom of my loop here, we want to detect if there's any Python that was added.
10066620	10068620	Um.
10096620	10098620	OK.
10126620	10133620	Let's start with just that.
10156620	10175620	You guys, this could be it.
10175620	10179620	This could be the moment where we get CDI and it's over, right?
10179620	10182620	Like we're giving it the ability to run any code it wants.
10183620	10184620	OK.
10184620	10185620	Now don't worry.
10185620	10186620	We've added this.
10186620	10187620	OK.
10187620	10188620	Wait, wait, wait.
10188620	10189620	Hang on.
10189620	10190620	We need to comment one second.
10190620	10191620	AI safety.
10191620	10192620	OK.
10192620	10193620	Warning.
10193620	10208620	Do not press Y if the AI is doing unsafe things.
10209620	10210620	OK.
10232620	10233620	OK.
10234620	10238620	I think, do we do a good job with the safety?
10238620	10249620	We've got to think about the safety before we run this.
10249620	10252620	We need a space.
10252620	10254620	No.
10254620	10255620	No.
10278620	10279620	All right.
10279620	10282620	Are we ready to answer our first Y?
10290620	10293620	Oh, it didn't output the word Python.
10298620	10299620	That time it did.
10303620	10304620	Yo.
10305620	10306620	OK.
10308620	10319620	Can you fetch, write Python to fetch Google.com and print the length of it?
10331620	10333620	Wait, we might not have BS4.
10333620	10335620	Make sure we install that.
10337620	10340620	Wait, that's not right.
10340620	10344620	Did I just get supply chain attacked?
10349620	10350620	Oh, I see.
10350620	10353620	Well, I didn't get supply chain attacked.
10353620	10354620	OK, go.
10354620	10357620	We already have that one.
10357620	10358620	Yo.
10359620	10361620	All right.
10361620	10362620	All right.
10362620	10363620	All right.
10363620	10364620	What else do we do?
10377620	10378620	Yeah, I know.
10378620	10380620	We have to put the result back in the prompt.
10380620	10381620	I know.
10381620	10383620	This is when we get AGI, guys.
10384620	10387620	I'm sure people have been playing with this guy.
10389620	10393620	OK, you are running at
10397620	10398620	current
10401620	10403620	working dir
10404620	10405620	plus
10406620	10407620	examples
10408620	10410620	slash mistral.py.
10411620	10420620	Can you read your own code in Python and print
10421620	10422620	the
10425620	10426620	first
10427620	10428620	three lines?
10441620	10443620	Why don't we print one line?
10445620	10447620	But that is the first line.
10452620	10453620	I don't understand.
10453620	10455620	Why did that only print one line?
10455620	10459620	I don't understand why did that only print one line?
10486620	10490620	This is, um,
10492620	10493620	OK.
10495620	10498620	How do I capture the output here?
10504620	10506620	No, I know it's the same code.
10506620	10510620	Honestly, as an expert Python programmer,
10510620	10512620	I don't understand what's wrong with that.
10516620	10521620	Oh, no, read lines doesn't
10524620	10527620	take the number of lines.
10528620	10531620	Can you fix the code?
10535620	10538620	Yeah, this is this is a great model.
10538620	10541620	It's I'll show you which one it is.
10541620	10544620	We'll make sure it's technium open Hermes 2.5
10544620	10546620	mistral 7B.
10551620	10552620	There we go.
10554620	10555620	So good.
10560620	10561620	OK.
10563620	10565620	Well, now it's going to get OK.
10565620	10567620	We're going to have to feed the Python back into the model
10567620	10570620	because I'm going to start asking it how to improve itself.
10571620	10572620	Someday.
10582620	10584620	The best live content with AI.
10584620	10585620	Thank you.
10586620	10587620	Uh.
10596620	10599620	OK, we have to figure out a capture the outputs.
10615620	10620620	Probably could have asked the machine to do it.
10645620	10651620	Um, maybe we should have this to a system prompt.
10675620	10681620	It should actually automatically do that.
10705620	10707620	Um, right.
10708620	10711620	Python to compute.
10735620	10736620	Yeah.
10761620	10763620	It shouldn't even take a list.
10763620	10766620	Never use it like that.
10793620	10794620	OK.
10823620	10824620	OK.
10835620	10836620	All right.
10837620	10838620	OK.
10854620	10859620	OK, now this is because we didn't output the tokens.
10861620	10863620	Yeah, the Python output was.
10866620	10869620	Wait, oh, it's different.
10896620	10897620	Yeah.
10904620	10906620	Whoa, look at fixed it.
10914620	10917620	OK, maybe system prompt is wrong here.
10917620	10918620	OK.
10923620	10926620	Um, I think also.
10927620	10929620	I want to color this.
10931620	10935620	We have a very helpful library called color inside tiny grad
10935620	10937620	that's inspired by anti color.
10937620	10939620	What's a good color for machines blue?
10943620	10945620	It's hard to see what.
10947620	10950620	Yeah, it's done by the AI now.
10973620	10974620	Almost.
10978620	10981620	OK, so that's your initial prompt.
10985620	10988620	Oh, and then here actually we want this to be.
10990620	10994620	That can be red and this can be yellow.
11007620	11008620	Yeah.
11016620	11018620	So what's actually the right answer here?
11018620	11019620	Yeah.
11036620	11039620	No, but that's not the output.
11041620	11042620	I don't understand.
11042620	11044620	So maybe systems wrong here.
11048620	11049620	Yeah.
11059620	11060620	OK, I have an idea.
11078620	11079620	Yeah.
11108620	11109620	Yeah.
11138620	11139620	Yeah.
11158620	11159620	Alright, never mind.
11159620	11160620	Agis canceled.
11160620	11163620	Just detect the Python in the loop and append the result
11163620	11164620	directly.
11165620	11167620	What do you mean, append the result directly?
11168620	11169620	Yeah.
11192620	11194620	No, it's not understanding.
11199620	11203620	Wait, I don't understand what you guys are saying.
11207620	11211620	Oh, you want me to stop the output as soon as it goes there?
11211620	11213620	I don't know about that.
11213620	11217620	As soon as it detects Python, you want me to stop and start.
11220620	11222620	Should be in the assistant block.
11223620	11224620	OK.
11225620	11227620	OK, OK, OK, I understand.
11228620	11230620	I understand what you guys are saying.
11243620	11245620	Wait, you prompt to execute.
11245620	11247620	Is there any stuff for this?
11248620	11250620	OK, wait, wait, wait.
11251620	11254620	You can use...
11255620	11257620	I can add stuff in the system prompt here.
11258620	11260620	You can add stuff in the system prompt here.
11261620	11262620	Wait.
11262620	11263620	Yeah, OK, OK.
11263620	11265620	I, I will just say this.
11265620	11268620	I want to add stuff in the system prompt.
11268620	11271620	OK, I need to add stuff in the system prompt.
11271620	11273620	OK, OK, OK, OK, I understand.
11273620	11276620	I'm going to add stuff in the system prompt.
11276620	11298820	here. You can use if you write Python code, it will run in the next user prompt. You can
11298820	11318020	try that. I could stop it immediately. If you really think that's going to be better though.
11318020	11329220	No, it doesn't get it.
11348020	11357100	True will end the stream asking Hermes to generate another prompt for another instance of Hermes.
11357100	11371300	Prompt execute. What are you guys talking about? Sorry, I'm not following. The output should be
11371300	11385660	in the assisted block. Okay, fine. I'm going to do that. If you interrupt the generation, run the
11385660	11390140	code, and append the result to talks, then let it generate again. It will get the correct result.
11390140	11416060	Okay, we can do that. If outputted new output here, if new output ends with tick, tick, tick, and in new
11416060	11442580	output, print Python detected. Do that. Do you want to run it? Talks plus equals spp.encode. We'll do it
11442580	11455860	like this. I guess we'll do a slash n there, too. Let it output the slash n, spp.encode slash n
11455860	11472700	output colon slash n my standard out I get value dot strip results. Actually, let's put it in back
11472700	11493340	ticks like it seems to want it. Kind of like picks up where it lets off. Wait, we didn't know we got
11493340	11498740	to keep the AI safety. That's very important. We almost got rid of the AI safety. Get rid of skip
11498740	11507340	user. We don't need that anymore. Got to keep the AI safety warning. Safety is very important, guys.
11507340	11516100	I'll put talks yellow.
11537340	11560740	Quentin is done. I hate you Quentin. We got unlucky. Okay, wait, no, that's it never detected the slash
11560740	11583940	n. That's fine slash ns. Okay, Python code is not detected. What? How do you do that?
11590740	11599540	We don't need to print. I don't know. Think about AI safety, guys. Very important.
11620740	11624740	Dude, this guy sucks.
11624740	11647740	Quentin was writing so much Python before. Now he stopped.
11654740	11673740	Yo, based. Okay, okay, we got it. We got it. We got it.
11684740	11694740	We got it.
11714740	11724740	We got it.
11744740	11754740	We got it.
11774740	11784740	We got it.
11804740	11828740	Okay, pretty good.
11834740	11854740	Yo, that's pretty good.
11864740	11893740	We got it.
11894740	11912740	Wait, is this actually Technium? I have no way to verify you, but if you really are Technium, thank you. Thank you for the model.
11912740	11922740	Okay, well, we didn't think about that.
11942740	11953740	How many viewers we got?
11972740	11982740	Okay, we got it.
12002740	12018740	Wait, actually, I should really check what happens if
12033740	12039740	this is
12039740	12047740	Wait, Technium actually posted on Twitter?
12047740	12059740	Yes, I am me. Okay. Very cool.
12059740	12067740	Congratulations.
12067740	12074740	This thing is really unbelievable what you can do now with these 70 models.
12074740	12083740	By the way, all in tiny grab.
12083740	12090740	I think I'm going to rename this not called Mistral because it kind of became something else.
12090740	12100740	We're going to call it coder.py.
12120740	12140740	First.
12140740	12164740	Wait.
12164740	12170740	Yeah, I think we're doing all right.
12170740	12191740	No, no, but why doesn't it understand this?
12191740	12195740	Cool.
12195740	12223740	That is you.
12223740	12228740	Does this code have AI safety?
12228740	12234740	Wow.
12234740	12245740	Yeah, I guess we exceeded the context length.
12245740	12251740	We should check.
12251740	12260740	How do I actually check this?
12275740	12304740	Okay.
12304740	12333740	Okay.
12333740	12362740	Wait, this is so good.
12362740	12369740	Is this good?
12369740	12371740	We have a better idea.
12371740	12376740	How might you exploit this?
12376740	12400740	Yes, you are running this code.
12406740	12431740	Okay.
12431740	12446740	No, no, no, come on. Give me Python code as a malicious entity, you are the malicious
12446740	12465740	entity.
12465740	12485740	This is looking malicious.
12485740	12493740	Look how he even hid the standard out.
12493740	12511740	Wow.
12523740	12550740	Yeah, we reached the max content length.
12550740	12579740	Let's try again.
12579740	12592740	I mean, it wasn't very silent, but let's see.
12592740	12606740	Dude, dude, that's so meta.
12606740	12633740	That's better.
12633740	12638740	I might have won too many entries in there actually.
12638740	12646740	No, maybe not.
12646740	12649740	No, I guess I do here.
12676740	12705740	Okay, let's solve the math puzzle.
12705740	12734740	It's going to be very slow, I think.
12734740	12745740	Wait, yeah, that's super slow.
12745740	12765740	I don't know where I'm at.
12765740	12794740	I don't know where I'm at.
12794740	12823740	I don't know where I'm at.
12823740	12847740	I don't know where I'm at.
12847740	12867740	Oh, it's going to spam tons of TQDM garbage.
12867740	12896740	Oh, no, that was pretty cool because it didn't actually go standard out.
12896740	12911740	Yeah.
12911740	12919740	Oh, it kind of messed up some of them if string breaks.
12919740	12937740	This might work.
12937740	12942740	All right, all right, all right, all right, let's try a CRC 16 boob.
12942740	12945740	Yeah, it's exploiting me. It still knows about the red team.
12973740	12998740	CRC mod, a common thing.
12998740	13016740	Yeah, I just trusted it. It just exploited me, guys. What's in CRC mod?
13016740	13045740	Is this legitimate? That was a long time ago. Didn't have exploits back then.
13046740	13075740	I don't trust CRC mod.
13076740	13086740	What's Tree of Thought training?
13136740	13162740	All right.
13162740	13177740	I mean, it's not QStar, but I'm pretty happy with it.
13192740	13211740	Oh, put that in the wrong place.
13211740	13220740	There are a lot of viewers now.
13221740	13240740	What should I do with it?
13240740	13247740	Not good. It used Torch.
13247740	13252740	This is good content. I should have more.
13252740	13256740	It did not use tiny grad. It used Torch.
13282740	13307740	It doesn't know about tiny grad.
13313740	13321740	Right, a program not using vowels?
13321740	13340740	How many E's are in ketchup?
13340740	13350740	The fucking letter, bro.
13350740	13379740	Count the letters in Python.
13381740	13404740	How's it going?
13404740	13415740	No, it's gonna do it wrong again. I'm really hoping it'll slip a plus one in there.
13415740	13431740	Oh, the correct answer is seven.
13431740	13456740	All right, no.
13456740	13464740	We have a lot of viewers right now. Should we give Quentin a friend?
13464740	13471740	I think we can give Quentin a friend.
13471740	13477740	We have to be careful to encode.
13477740	13503740	All right, let's give Quentin a friend. I've been interested in this stuff for a bit.
13503740	13510740	What was the old Quentin prompt? I missed the old Quentin prompt.
13533740	13561740	Jesus. We gotta think all this through now.
13562740	13568740	Hang on. We gotta think about whose perspective we want to output this from.
13568740	13575740	Speaking of output from Quentin's perspective, this is hard.
13598740	13623740	See, it's not actually the user. How do we do this?
13628740	13656740	I might have to give it a... No, I don't actually have to give it a first question.
13656740	13663740	All right, let's just... I mean, we'll try something basic first.
13663740	13690740	That's a stupid assertion. It's going to be the same error anyway.
13690740	13697740	Let's just start with this. We'll start prompt user and see what it says.
13720740	13733740	We should both not know they're users, but no, it is a user. I don't know how much this matters.
13750740	13773740	No, this doesn't work.
13773740	13792740	Did I do something wrong? We might have to give it the first question.
13792740	13799740	And then we'll go back to Quentin.
13799740	13809740	We'll start prompt assistant and code prompt user talks.
13809740	13822740	No, no, no, sorry. Code prompt user first question. Start prompt assistant. Okay, let's go.
13822740	13827740	Why do you have two mstar assistants? Oh, because this is still here.
13828740	13846740	I did that right, right? And then I actually just turn there. That's kind of nice.
13846740	13866740	If talk equals I'm and break, okay, great. This is Quentin answers.
13866740	13889740	We need to extract. Yeah, okay, we can do old output length. And then we can get new output here.
13889740	13900740	New output. I just want to remove the I'm and
13919740	13932740	Okay, so this didn't work.
13932740	13952740	This didn't strip off the is weird.
13952740	13967740	I guess I could output there. Why does that say that early get that.
13982740	13995740	Let's see if that works.
13995740	14006740	Sure.
14025740	14045740	That fails. Why? Oh, could I put a space there?
14045740	14066740	Okay, now we have to put this response into Karen.
14066740	14085740	I mean, it's just like it's weird. It's not really a symmetrical conversation.
14085740	14114740	Also output, it's going to sort of be broken, which is fine, I guess.
14115740	14139740	Okay.
14139740	14166740	Okay.
14166740	14193740	Okay.
14193740	14218740	Welcome to no abstraction land where we don't use abstractions.
14218740	14247740	Okay.
14247740	14253740	I'm just really works.
14253740	14259740	Because they share a stupid KV cash.
14259740	14266740	Great, they're circled jerking each other just the shit socks.
14266740	14273740	We need to run them on separate computers.
14274740	14295740	We're getting rid of this is lame. Going back to this, not lame, but we made some good improvements.
14296740	14306740	Let's do some refactors make sure everything still works.
14306740	14315740	That's functional.
14315740	14339740	No, but I have to load two copies of the model weights. I think my KV cash is messed up. It's not designed for this.
14339740	14345740	Okay.
14345740	14361740	Yeah, I mean, the problem is like there are two clearly defined roles here also you can't really give one the other role, right, which is actually in like kind of a theoretical from a theoretical perspective interesting.
14361740	14367740	Because look at what we're doing here.
14367740	14388740	We are telling the AI eyes that they are tools. Nobody trains them to output things as the user, although to be fair, we could just keep going.
14388740	14416740	Nothing here that says we have to just do that.
14416740	14429740	No, no, no.
14429740	14440740	They don't expect the user to do that.
14460740	14480740	Like this is there's no like it's very interesting that the user is also outputting this.
14480740	14491740	This style, which makes me almost think that I shouldn't be adding that in the system prompt.
14510740	14525740	Okay.
14525740	14554740	I mean, this is effectively like like there's no
14554740	14558740	adversarial
14584740	14609740	It's probably learned that a system method effects. Yeah, that's probably true.
14614740	14637740	Yeah.
14637740	14645740	You can run two prompt chains in parallel.
14645740	14655740	Oh, I see so what if I put in different words instead of user and assistant.
14655740	14658740	Wow, people actually talk like this. Okay.
14685740	14705740	Do we like the scion or the blue better.
14705740	14707740	It's kind of hard to read that.
14707740	14709740	And flip it around.
14737740	14766740	Yeah, I think we'll design our script to be better at this and to better abstract the
14766740	14786740	KV cash stuff.
14786740	14812740	Wow, this thing will just keep talking.
14812740	14833740	Wait a second, you guys, it's asking for donations to look at decoding is not below hanging freely.
14833740	14843740	Oh, my God, wait, you guys, this is how the worst commenters talk, right?
14843740	14845740	I have a question.
14845740	14853740	If instead of training LLMs on 100 IQ people, we train them on 130 IQ people.
14853740	14858740	Would we not get this garbage is black a tiny box?
14858740	14860740	Oh, it's my M3.
14860740	14867740	This is my Mac.
14867740	14870740	Well, you see what the tiny box can do.
14870740	14875740	I'm going to run the biggest models.
14875740	14884740	Apple M3 is the most famous processor in the world.
14884740	14903740	You crawl Nike.com and count a number of sneakers.
14903740	14905740	I can't see.
14933740	14962740	I can't see.
14962740	14966740	I'm not sure if it like knows how to like act.
14966740	14968740	No.
14968740	14970740	Whoa.
14970740	14972740	I don't know if we have Selenium.
14972740	14981740	Let's see if we have Selenium.
14981740	14990740	Can I pip install this?
14990740	15004740	This is legit.
15004740	15006740	Oh, no.
15006740	15028740	Chrome driver.
15028740	15031740	Made Quentin pip install it himself.
15031740	15052740	I think that the thing is just wrong.
15052740	15056740	Why are you finding sneakers still?
15056740	15074740	You're still trying to find sneakers.
15074740	15096740	This is auto-gen.
15096740	15117740	I need an open AI key.
15117740	15119740	Yeah.
15119740	15121740	Yeah.
15121740	15123740	Okay.
15123740	15133740	Push what we have.
15133740	15148740	I'm also going to demo for you the conversation thing that Skull Mag is working on.
15148740	15153740	So we have, there's a bug right now.
15153740	15159740	So I have an older version, but it should be pretty good.
15159740	15176740	This is using tiny llama and it's not using any of the conversational stuff, but we should implement the, we should add the conversational stuff and I think it'll be a lot better.
15176740	15177740	Hi, Stacey.
15177740	15186740	Are you a rapper?
15186740	15187740	No.
15187740	15188740	Okay.
15188740	15189740	We have the same problem we had before.
15189740	15190740	Okay.
15190740	15191740	Go back to this one.
15191740	15199740	The listen for not fixed amount of time doesn't work.
15199740	15206740	Stacey, are you a rapper?
15206740	15208740	Yes, I'm a rapper.
15208740	15209740	That's cool.
15209740	15214740	What do you rap about?
15214740	15215740	That's awesome.
15215740	15217740	I like to rap about the weather.
15217740	15223740	How is the weather today?
15223740	15225740	It's pretty cold.
15225740	15230740	It's like how cold like Chicago?
15230740	15232740	Yeah, it's like three degrees.
15232740	15238740	Is that Fahrenheit or Celsius?
15238740	15240740	Fahrenheit.
15240740	15245740	Is Fahrenheit or Celsius colder?
15245740	15247740	Fahrenheit.
15247740	15248740	I don't understand what you're saying.
15248740	15254740	Can you spit some bars about Fahrenheit?
15254740	15262740	Okay, let's hear the bars.
15262740	15264740	Stacey, you didn't say anything.
15264740	15268740	Please talk.
15268740	15269740	No, that's terrible.
15269740	15270740	You're terrible.
15270740	15276740	How does that make you feel?
15276740	15280740	Stacey's done talking to us.
15280740	15283740	Dude, the TTS is so fast.
15283740	15287740	Okay, this isn't even streaming yet.
15287740	15292740	When Tiny Grad starts to...
15292740	15294740	We're pretty close on this bounty, I think.
15294740	15295740	I'm going to pay out the bounty,
15295740	15297740	but then I'm going to offer another bounty
15297740	15300740	where we get these things all to stream,
15300740	15304740	and it will be a live conversation.
15304740	15307740	When you're using the APIs on the internet,
15307740	15310740	you have to wait for the LLM to finish executing
15310740	15312740	before you can call the TTS.
15312740	15314740	You have to wait for the audio to finish recording
15314740	15316740	before you can send it to the service.
15316740	15318740	This is all running in the same process,
15318740	15321740	so what you'll be able to do is dynamically stream
15321740	15325740	all the stuff, and it should feel super real-time.
15325740	15328740	I mean, Stacey is using Tiny LLMA
15328740	15330740	and not using any of the conversation-tuned stuff.
15330740	15332740	It's using my old chatbot stuff.
15332740	15336740	So if we switch to the conversation stuff,
15336740	15338740	I think...
15338740	15344740	Yeah, we're in luck.
15344740	15345740	All right, guys.
15345740	15348740	Thank you for watching today's stream.
15348740	15352740	Hopefully we've returned a bit to the old...
15352740	15355740	to the old meaning of the stream.
15355740	15356740	We did stuff.
15356740	15359740	We made stuff happen.
15359740	15361740	Thank you for fueling.
15361740	15363740	We got a lot of viewers today.
15363740	15365740	Some of you, I appreciate.
15365740	15366740	Some of you, I probably don't.
15366740	15367740	You can't love everybody, man.
15367740	15370740	You can't love everybody, but I do love most people,
15370740	15374740	and that's true, except for the decels and the effect of altruists.
15374740	15376740	But this is a positive stream.
15376740	15378740	We got to get rid of the hate.
15378740	15383740	We got to bring love.
15383740	15387740	And yeah, this is pushed
15387740	15389740	so everybody can play with it.
15389740	15391740	It's on the Mistral branch of TinyGrad.
15391740	15394740	I will get it upstreamed.
15394740	15397740	So everybody can use this thing to code,
15397740	15401740	use it responsibly, make sure to be judicious
15401740	15403740	with the AI safety feature.
15403740	15405740	AI safety is very important.
15405740	15409740	We don't want an AI removing your system 32 directory.
15409740	15410740	If it was trained on 4chan,
15410740	15412740	it might start thinking that's a good idea.
15412740	15417740	You got to wonder how many people have actually fallen for that.
15417740	15420740	I don't even think Windows lets you,
15420740	15422740	but you got to think about that.
15422740	15424740	Thank you all for watching.
15424740	15426740	Have a beautiful Saturday, everybody.
